# ๐ฏ ูุณุชูุฏ ุงูุชูููุฐ ุงูุดุงูู - ุงุณุชุฎุฏุงู Excel ููุงุนุฏุฉ ุจูุงูุงุช

## ุงููุญุชููุงุช
1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุจููุฉ ุงูุจูุงูุงุช](#ุจููุฉ-ุงูุจูุงูุงุช)
3. [ุงูุฏูุงู ุงููุชุงุญุฉ](#ุงูุฏูุงู-ุงููุชุงุญุฉ)
4. [ูุงุฌูุงุช API](#ูุงุฌูุงุช-api)
5. [ุงูุชูุงูู ูุน ุงููุธุงู](#ุงูุชูุงูู-ูุน-ุงููุธุงู)
6. [ุฃูุซูุฉ ุนูููุฉ](#ุฃูุซูุฉ-ุนูููุฉ)

---

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุชูุงูู ูุณุชุฎุฏู ููู Excel (`used_tables_export.xlsx`) ููุงุนุฏุฉ ุจูุงูุงุช ุฑุฆูุณูุฉ ูููุดุฑูุน. ูุฐุง ุงููุธุงู ูููุฑ:

โ **ุจูุงูุงุช 2,571 ูุชุฏุฑุจ** ูุน ูู ูุนูููุงุชูู  
โ **ุฅุฏุงุฑุฉ 5 ุฃุฏููุฉ** ูุน ูุนูููุงุช ุงููุฎุฒูู ูุงูุญุฑูุงุช  
โ **ุณุฌูุงุช 23 ุฒูุงุฑุฉ ุนูุงุฏูุฉ** ูููุชุฏุฑุจูู  
โ **6 ุฏูุฑุงุช ุชุฏุฑูุจูุฉ** ูุน ูุนูููุงุช ุงูุฌุฏููุฉ  
โ **11 ูุณู ูู 4 ูููุงุช** ูููููู ุงูุชูุธููู  
โ **3 ูุณุชุฎุฏููู** ูุน ุตูุงุญูุงุช ูุฎุชููุฉ  

---

## ุจููุฉ ุงูุจูุงูุงุช

### ุฌุฏุงูู Excel ุงููุชุงุญุฉ

#### 1. ุฌุฏูู ุงููุชุฏุฑุจูู (SF01) - 2,571 ุณุฌู
| ุงูุนููุฏ | ุงูููุน | ุงููุตู |
|--------|-------|-------|
| student_id | ูุต | ุฑูู ุงููุชุฏุฑุจ ุงููุฑูุฏ |
| student_Name | ูุต | ุงูุงุณู ุงููุงูู |
| Major | ูุต | ุงูุชุฎุตุต |
| College | ูุต | ุงููููุฉ |
| Department | ูุต | ุงููุณู |
| Phone | ูุต | ุฑูู ุงููุงุชู |
| Email | ูุต | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| Enrollment_Date | ุชุงุฑูุฎ | ุชุงุฑูุฎ ุงูุชุณุฌูู |
| Status | ูุต | ุงูุญุงูุฉ (active/graduated/retired) |

#### 2. ุฌุฏูู ุงูุฃุฏููุฉ (Drugs) - 5 ุฃุฏููุฉ
| ุงูุนููุฏ | ุงูููุน | ุงููุตู |
|--------|-------|-------|
| id | ุฑูู | ูุนุฑู ุงูุฏูุงุก |
| trade_name | ูุต | ุงูุงุณู ุงูุชุฌุงุฑู |
| generic_name | ูุต | ุงูุงุณู ุงูุนุงู |
| strength | ูุต | ุงูููุฉ (ูุซู 500mg) |
| form | ูุต | ุงูุดูู (ุฃูุฑุงุต/ุดุฑุงุจ) |
| unit | ูุต | ูุญุฏุฉ ุงูููุงุณ |
| stock_qty | ุฑูู | ุงููููุฉ ุงููุชุงุญุฉ |
| reorder_level | ุฑูู | ุงูุญุฏ ุงูุฃุฏูู ููุทูุจ |
| is_active | ููุทูู | ูู ุงูุฏูุงุก ูุดุท |
| manufacturer | ูุต | ุงูุดุฑูุฉ ุงูููุชุฌุฉ |

#### 3. ุฌุฏูู ูุฑุถู ุงูุนูุงุฏุฉ (Clinic_Patients) - 23 ุณุฌู
| ุงูุนููุฏ | ุงูููุน | ุงููุตู |
|--------|-------|-------|
| id | ุฑูู | ูุนุฑู ุงูุณุฌู |
| trainee_no | ูุต | ุฑูู ุงููุชุฏุฑุจ |
| full_name | ูุต | ุงูุงุณู ุงููุงูู |
| age | ุฑูู | ุงูุนูุฑ |
| gender | ูุต | ุงูุฌูุณ |
| college | ูุต | ุงููููุฉ |
| department | ูุต | ุงููุณู |
| visit_date | ุชุงุฑูุฎ | ุชุงุฑูุฎ ุงูุฒูุงุฑุฉ |
| chief_complaint | ูุต | ุงูุดููู ุงูุฑุฆูุณูุฉ |
| diagnosis | ูุต | ุงูุชุดุฎูุต |
| prescribed_medication | ูุต | ุงูุฃุฏููุฉ ุงููุตุฑููุฉ |
| notes | ูุต | ููุงุญุธุงุช |

#### 4. ุฌุฏุงูู ุฃุฎุฑู
- **Courses** (6) - ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ
- **Departments** (11) - ุงูุฃูุณุงู
- **Colleges** (4) - ุงููููุงุช
- **Users** (3) - ุงููุณุชุฎุฏููู
- **Drug_Movements** (26) - ุญุฑูุงุช ุงูุฃุฏููุฉ
- **Locations** (3) - ููุงูุน ุงูุชุฎุฒูู

---

## ุงูุฏูุงู ุงููุชุงุญุฉ

### ุงููููุน: `excel_data_reference.py`

#### ุฏูุงู ุงููุชุฏุฑุจูู
```python
get_student_by_id(student_id: str) -> Dict
search_students(query: str) -> List
get_students_by_college(college_name: str) -> List
get_students_by_major(major: str) -> List
get_students_by_status(status: str) -> List
```

#### ุฏูุงู ุงูุฃุฏููุฉ
```python
get_all_drugs() -> List
get_drug_by_name(trade_name: str) -> Dict
get_drug_by_generic_name(name: str) -> Dict
get_drug_by_code(drug_code: str) -> Dict
search_drugs(query: str) -> List
get_drugs_by_status(is_active: bool) -> List
get_low_stock_drugs(threshold: int = None) -> List
get_drug_stock(drug_code: str) -> Dict
```

#### ุฏูุงู ุงูุนูุงุฏุฉ
```python
get_clinic_patient_by_trainee_no(trainee_no: str) -> Dict
search_clinic_patients(query: str) -> List
get_clinic_patients_by_college(college: str) -> List
```

#### ุฏูุงู ุงูุชูุธูู
```python
get_all_colleges() -> List
get_all_departments() -> List
get_departments_by_college(college_name: str) -> List
get_courses_by_department(department_name: str) -> List
```

#### ุฏูุงู ุงูุฅุญุตุงุฆูุงุช
```python
get_statistics() -> Dict
get_statistics_by_college(college_name: str) -> Dict
get_statistics_by_department(department_name: str) -> Dict
```

---

## ูุงุฌูุงุช API

### Base URL
```
http://localhost:8000/api/excel
```

### ุชุตูููุงุช API

#### 1๏ธโฃ ุงูุฅุญุตุงุฆูุงุช
```
GET /statistics
GET /statistics/by-college/{college_name}
GET /statistics/by-department/{department_name}
```

#### 2๏ธโฃ ุงูุจุญุซ ุนู ุงููุชุฏุฑุจูู
```
GET /students/search?q={query}&limit=10
GET /students/{student_id}
GET /students/by-college/{college_name}
GET /students/by-major/{major_name}
GET /students/by-status/{status}
```

#### 3๏ธโฃ ุงูุฃุฏููุฉ
```
GET /drugs/all
GET /drugs/search?name={name}
GET /drugs/search/advanced?query={query}
GET /drugs/low-stock?threshold={threshold}
GET /drugs/status/{status}
```

#### 4๏ธโฃ ุงูุนูุงุฏุฉ
```
GET /clinic/search?query={query}&limit=10
GET /clinic/patients/{trainee_no}
```

#### 5๏ธโฃ ุงูุชูุธูู
```
GET /colleges/all
GET /departments/all
GET /departments/by-college/{college_name}
GET /courses/by-department/{department_name}
```

---

## ุงูุชูุงูู ูุน ุงููุธุงู

### 1. ุตูุฏููุฉ ุงูุฃุฏููุฉ
- ุนุฑุถ ุฌููุน ุงูุฃุฏููุฉ ูู Excel
- ุชุญุฏูุซ ุงููุฎุฒูู ุนูุฏ ุงูุตุฑู
- ุชูุจููุงุช ุงููุฎุฒูู ุงูููุฎูุถ

### 2. ุตูุฏูู ุงูุฅุณุนุงูุงุช ุงูุฃูููุฉ
- ุงุฎุชูุงุฑ ุงูุฃุฏููุฉ ูู Excel
- ุงูุชุญูู ูู ุงููููุฉ ุงููุชุงุญุฉ
- ุฅุถุงูุฉ ุงูุฃุฏููุฉ ุฅูู ุงูุตูุฏูู

### 3. ูุธุงู ุงูุนูุงุฏุฉ
- ุงูุจุญุซ ุนู ุงููุชุฏุฑุจูู
- ุฑุจุท ูุน ุงูุณุฌูุงุช ุงูุทุจูุฉ
- ุชุณุฌูู ุงูุฃุฏููุฉ ุงููุตุฑููุฉ

### 4. ูุธุงู ุฅุฏุงุฑุฉ ุงูุฏูุฑุงุช
- ุนุฑุถ ุงูุฏูุฑุงุช ุงููุชุงุญุฉ
- ุชุณุฌูู ุงููุชุฏุฑุจูู
- ุฅุตุฏุงุฑ ุงูุดูุงุฏุงุช

### 5. ููุญุฉ ุงูุจูุงูุงุช ุงูุดุงููุฉ
- `/admin/excel-data` - ุนุฑุถ ุดุงูู ูุฌููุน ุจูุงูุงุช Excel
- ุฅุญุตุงุฆูุงุช ูุญุธูุฉ
- ุชูุจููุงุช ุงููุฎุฒูู ุงูููุฎูุถ
- ุนููุงุช ูู ุงูุจูุงูุงุช

---

## ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุงูุจุญุซ ุนู ูุชุฏุฑุจ ูุนุฑุถ ุณุฌูู ุงูุทุจู

```python
from excel_data_reference import get_student_by_id, get_clinic_patient_by_trainee_no

# ุงูุจุญุซ ุนู ุงููุชุฏุฑุจ
student = get_student_by_id("2101024")
print(f"ุงูุงุณู: {student['student_Name']}")
print(f"ุงููููุฉ: {student['College']}")

# ุงูุญุตูู ุนูู ุงูุณุฌู ุงูุทุจู
patient = get_clinic_patient_by_trainee_no("2101024")
print(f"ุงูุชุดุฎูุต: {patient['diagnosis']}")
print(f"ุงูุฃุฏููุฉ ุงููุตุฑููุฉ: {patient['prescribed_medication']}")
```

### ูุซุงู 2: ุงูุจุญุซ ุนู ุงูุฃุฏููุฉ ุฐุงุช ุงููุฎุฒูู ุงูููุฎูุถ

```python
from excel_data_reference import get_low_stock_drugs

# ุงูุญุตูู ุนูู ุงูุฃุฏููุฉ ุฐุงุช ุงููุฎุฒูู ุงูููุฎูุถ
low_stock = get_low_stock_drugs()

for drug in low_stock:
    print(f"โ๏ธ {drug['trade_name']}: {drug['stock_qty']} (ุงูุญุฏ ุงูุฃุฏูู: {drug['reorder_level']})")
    # ูููู ุฅุฑุณุงู ุฅุดุนุงุฑ ุฃู ุชูุฑูุฑ
```

### ูุซุงู 3: ุฅุญุตุงุฆูุงุช ุงููููุฉ

```python
from excel_data_reference import get_statistics_by_college

stats = get_statistics_by_college("ุงูููุฏุณุฉ")
print(f"ุนุฏุฏ ุงููุชุฏุฑุจูู: {stats['students_count']}")
print(f"ุงููุฑุถู ุงูุฐูู ุฒุงุฑูุง ุงูุนูุงุฏุฉ: {stats['clinic_patients_count']}")
print(f"ุงูุชุฎุตุตุงุช: {', '.join(stats['majors'])}")
```

### ูุซุงู 4: ุงุณุชุฎุฏุงู API ูู JavaScript

```javascript
// ุงูุจุญุซ ุนู ูุชุฏุฑุจ
fetch('/api/excel/students/search?q=ูุญูุฏ&limit=5')
  .then(res => res.json())
  .then(data => {
    data.results.forEach(student => {
      console.log(`${student.student_Name} (${student.student_id})`);
    });
  });

// ุงูุฃุฏููุฉ ุฐุงุช ุงููุฎุฒูู ุงูููุฎูุถ
fetch('/api/excel/drugs/low-stock')
  .then(res => res.json())
  .then(data => {
    console.log(`ุนุฏุฏ ุงูุฃุฏููุฉ ุจูุฎุฒูู ููุฎูุถ: ${data.count}`);
    data.drugs.forEach(drug => {
      console.log(`โ๏ธ ${drug.trade_name}: ${drug.stock_qty}/${drug.reorder_level}`);
    });
  });

// ุงูุฅุญุตุงุฆูุงุช ุญุณุจ ุงููููุฉ
fetch('/api/excel/statistics/by-college/ุงูููุฏุณุฉ')
  .then(res => res.json())
  .then(data => {
    console.log('ุฅุญุตุงุฆูุงุช ุงูููุฏุณุฉ:', data.statistics);
  });
```

---

## ๐๏ธ ููุญุฉ ุงูุชุญูู ุงูุดุงููุฉ

ุฒูุงุฑุฉ `/admin/excel-data` ุชููุฑ:

- ๐ **ุฅุญุตุงุฆูุงุช ุจุตุฑูุฉ** ูุฌููุน ุงูุจูุงูุงุช
- ๐ **ูุงุฆูุฉ ุงูุฃุฏููุฉ** ูุน ุงููููุงุช ุงููุชุงุญุฉ
- โ๏ธ **ุชูุจููุงุช ุงููุฎุฒูู ุงูููุฎูุถ**
- ๐ซ **ุงููููุงุช ูุงูุฃูุณุงู**
- ๐ฅ **ุนููุงุช ูู ุงููุชุฏุฑุจูู**
- ๐ฅ **ุนููุงุช ูู ุงููุฑุถู**
- ๐ **ุฑูุงุจุท ุณุฑูุนุฉ ููู APIs**

---

## ๐ ุงูููุงุท ุงููููุฉ

โ **ุงูุจูุงูุงุช ูุฑุงุกุฉ ููุท**: ูุง ูููู ุชุนุฏูู ุจูุงูุงุช Excel ูู ุฎูุงู ุงูุชุทุจูู  
โ **ุชุฎุฒูู ูุคูุช**: ุงูุจูุงูุงุช ูุญููุฉ ูู ุงูุฐุงูุฑุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู ููุฃุฏุงุก ุงูุณุฑูุน  
โ **ุงูุฏูุฉ**: ุฌููุน ุงูุฃุณูุงุก ูุงูุฃุฑูุงู ูุทุงุจูุฉ ุชูุงูุงู ูุน Excel  
โ **ุงูุชูุงูู ุณูุณ**: ูุชูุงูู ุจุณูููุฉ ูุน ุจุงูู ุฃูุธูุฉ ุงูุชุทุจูู  
โ **ูุงุจููุฉ ุงูุชูุณุน**: ูููู ุฅุถุงูุฉ ุฌุฏุงูู ูุฃุนูุฏุฉ ุฌุฏูุฏุฉ ุจุณูููุฉ  

---

## ๐ ุงูุชูุตูุงุช

1. **ุงูุชุญุฏูุซุงุช**: ุฅุฐุง ุชุบูุฑุช ุจูุงูุงุช Excelุ ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู
2. **ุงููุฑุงูุจุฉ**: ุงุณุชุฎุฏู ููุญุฉ ุงูุจูุงูุงุช ูููุฑุงูุจุฉ ุงููุณุชูุฑุฉ
3. **ุงูุชูุจููุงุช**: ูู ุจุฅุนุฏุงุฏ ุชูุจููุงุช ูููุฎุฒูู ุงูููุฎูุถ
4. **ุงูุชูุงุฑูุฑ**: ุงุณุชุฎุฏู ุงูู APIs ูุฅูุดุงุก ุชูุงุฑูุฑ ูุฎุตุตุฉ
5. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู Excel

---

## ๐ง ูููุณุงุนุฏุฉ

ุชู ุชูุซูู ุฌููุน ุงูุฏูุงู ูุงูู APIs ุจุดูู ูุงูู. ุฑุงุฌุน:
- `EXCEL_API_GUIDE.md` - ุฏููู ุงูู APIs ุงูุชูุตููู
- `excel_data_reference.py` - ุงูููุฏ ุงููุตุฏุฑู
- `/admin/excel-data` - ููุญุฉ ุงูุจูุงูุงุช ุงูุชูุงุนููุฉ
